<div class="live-events-page">
  <!-- Barra de Filtros -->
  <div class="filter-bar">
    <button (click)="setFilter('ALL')" [class.active]="selectedFilter() === 'ALL'">
      {{ 'LIVE_EVENTS.FILTER_ALL' | translate }}
    </button>
    <button (click)="setFilter(FatigueLevel.ALTO)" [class.active]="selectedFilter() === FatigueLevel.ALTO">
      {{ 'LIVE_EVENTS.FILTER_HIGH' | translate }}
    </button>
    <button (click)="setFilter(FatigueLevel.MEDIO)" [class.active]="selectedFilter() === FatigueLevel.MEDIO">
      {{ 'LIVE_EVENTS.FILTER_MEDIUM' | translate }}
    </button>
    <button (click)="setFilter(FatigueLevel.BAJO)" [class.active]="selectedFilter() === FatigueLevel.BAJO">
      {{ 'LIVE_EVENTS.FILTER_LOW' | translate }}
    </button>
  </div>

  <!-- Contenido Principal -->
  <div class="main-content">
    <!-- Sección del Mapa -->
    <div class="map-container">
      <div class="map" id="live-map"></div>
    </div>
    <!-- Sección de Feed de Eventos -->
    <div class="events-feed">
      <h3 class="feed-title">{{ 'LIVE_EVENTS.FEED_TITLE' | translate }}</h3>
      <div class="event-list">
        @for (event of filteredEvents(); track event.id) {
        <div
          class="event-card"
          [class]="'event-card level-' + event.fatigueLevel.toLowerCase() + (event.isNewCritical ? ' critical-event-new' : '')"
        >
          <div class="event-header">
            <span class="font-bold">{{ event.fatigueLevel }}</span>
            <span>{{ event.timestamp | timeAgo }}</span>
          </div>
          <div class="event-body">
            <p><strong>{{ 'LIVE_EVENTS.CARD_DRIVER' | translate }}:</strong> {{ event.driver?.nombre || ('LIVE_EVENTS.CARD_LOADING' | translate) }}</p>
            <p><strong>{{ 'LIVE_EVENTS.CARD_VEHICLE' | translate }}:</strong> {{ event.vehicleId }}</p>
            <p><strong>{{ 'LIVE_EVENTS.CARD_TYPE' | translate }}:</strong> {{ event.fatigueType }}</p>
          </div>
        </div>
        } @empty {
        <div class="empty-feed">
          <p>{{ 'LIVE_EVENTS.EMPTY_FEED' | translate }}</p>
        </div>
        }
      </div>
    </div>
  </div>
</div>
