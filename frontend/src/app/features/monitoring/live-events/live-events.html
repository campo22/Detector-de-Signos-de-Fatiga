<div class="live-events-page">
  <!-- Barra de Filtros -->
  <div class="filter-bar">
    <button (click)="setFilter('ALL')" [class.active]="selectedFilter() === 'ALL'">
      Todos
    </button>
    <button (click)="setFilter(FatigueLevel.ALTO)" [class.active]="selectedFilter() === FatigueLevel.ALTO">
      Nivel Alto
    </button>
    <button (click)="setFilter(FatigueLevel.MEDIO)" [class.active]="selectedFilter() === FatigueLevel.MEDIO">
      Nivel Medio
    </button>
    <button (click)="setFilter(FatigueLevel.BAJO)" [class.active]="selectedFilter() === FatigueLevel.BAJO">
      Nivel Bajo
    </button>
  </div>

  <!-- Contenido Principal -->
  <div class="main-content">
    <!-- Sección del Mapa -->
    <div class="map-container">
      <div class="map" id="live-map"></div>
    </div>
    <!-- Sección de Feed de Eventos -->
    <div class="events-feed">
      <h3 class="feed-title">Feed de Eventos en Vivo</h3>
      <div class="event-list">
        @for (event of filteredEvents(); track event.id) {
        <div class="event-card" [ngClass]="'level-' + event.fatigueLevel.toLowerCase()">
          <div class="event-header">
            <span class="font-bold">{{ event.fatigueLevel }}</span>
            <span>{{ event.timestamp | timeAgo }}</span>
          </div>
          <div class="event-body">
            <p><strong>Conductor:</strong> {{ event.driver?.nombre || 'Cargando...' }}</p>
            <p><strong>Vehículo:</strong> {{ event.vehicleId }}</p>
          </div>
        </div>
        } @empty {
        <div class="empty-feed">
          <p>Esperando nuevos eventos...</p>
        </div>
        }
      </div>
    </div>
  </div>
</div>
