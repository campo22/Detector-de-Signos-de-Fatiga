<div class="bg-card rounded-xl shadow-lg overflow-hidden border border-border flex flex-col h-full">
  <div class="overflow-x-auto flex-1">
    <table class="w-full text-sm text-left text-muted-foreground">
      <thead
        class="text-xs text-muted-foreground uppercase bg-secondary/30 backdrop-blur-sm sticky top-0 z-10"
      >
        <tr>
          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('nombre')"
          >
            Nombre @if(sortState().column === 'nombre'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>
          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('licencia')"
          >
            Licencia @if(sortState().column === 'licencia'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>
          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('activo')"
          >
            Estado @if(sortState().column === 'activo'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>
          <th scope="col" class="px-6 py-3">Vehículo Asignado</th>
          <th scope="col" class="px-6 py-3 text-center">Acciones</th>
        </tr>
      </thead>

      @if (driversPage(); as page) {
      <tbody>
        @for (driver of page.content; track driver.id) {
        <tr class="bg-card border-b border-border hover:bg-muted/30 transition-colors">
          <td class="px-6 py-4 font-medium text-foreground whitespace-nowrap">
            {{ driver.nombre }}
          </td>
          <td class="px-6 py-4">{{ driver.licencia }}</td>
          <td class="px-6 py-4">
            <span
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
              [ngClass]="
                driver.activo
                  ? 'status-active bg-success/10 text-success'
                  : 'status-inactive bg-destructive/10 text-destructive'
              "
            >
              <span
                class="w-2 h-2 mr-1.5 rounded-full"
                [ngClass]="driver.activo ? 'bg-success' : 'bg-destructive'"
              ></span>
              {{ driver.activo ? 'Activo' : 'Inactivo' }}
            </span>
          </td>
          <td class="px-6 py-4">N/A</td>
          <td class="px-6 py-4 text-center">
            <div class="flex items-center justify-center gap-2">
              <button
                (click)="editDriver(driver.id)"
                title="Editar"
                class="p-1 text-muted-foreground hover:text-primary transition-colors"
              >
                <span class="material-symbols-outlined">edit</span>
              </button>
              <button
                (click)="viewDriverDetails(driver.id)"
                title="Ver Detalles"
                class="p-1 text-muted-foreground hover:text-primary transition-colors"
              >
                <span class="material-symbols-outlined">visibility</span>
              </button>
              <button
                (click)="deleteDriver(driver.id, driver.nombre)"
                title="Eliminar"
                class="p-1 text-muted-foreground hover:text-red-500 transition-colors"
              >
                <span class="material-symbols-outlined">delete</span>
              </button>
            </div>
          </td>
        </tr>
        }
      </tbody>
      }
    </table>

    @if (driversPage() !== null && driversPage()?.content?.length === 0) {
    <div class="text-center text-muted-foreground p-10">
      <span class="material-symbols-outlined text-4xl mb-2">person_search</span>
      <p>No se encontraron conductores con los filtros aplicados.</p>
    </div>
    } @if (driversPage() === null) {
    <div class="flex items-center justify-center text-muted-foreground p-10">
      <span class="material-symbols-outlined text-4xl animate-spin mr-2">progress_activity</span>
      Cargando conductores...
    </div>
    }
  </div>

  @if (driversPage(); as page) {
  <nav
    aria-label="Table navigation"
    class="flex flex-col sm:flex-row items-center justify-between p-4 border-t border-border gap-3"
  >
    <span class="text-sm font-normal text-muted-foreground">
      Mostrando <span class="font-semibold text-foreground">{{ page.numberOfElements }}</span> de
      <span class="font-semibold text-foreground">{{ page.totalElements }}</span>
    </span>
    <ul class="inline-flex items-center -space-x-px text-sm h-8">
      <li>
        <button
          (click)="previousPage()"
          [disabled]="page.first"
          class="flex items-center justify-center px-3 h-8 ml-0 leading-tight text-muted-foreground bg-card border border-border rounded-l-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        >
          <span class="material-symbols-outlined text-base">chevron_left</span>
        </button>
      </li>
      <li class="px-3 h-8 flex items-center text-muted-foreground bg-card border-y border-border">
        Pág {{ page.number + 1 }} de {{ page.totalPages }}
      </li>
      <li>
        <button
          (click)="nextPage()"
          [disabled]="page.last"
          class="flex items-center justify-center px-3 h-8 leading-tight text-muted-foreground bg-card border border-border rounded-r-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        >
          <span class="material-symbols-outlined text-base">chevron_right</span>
        </button>
      </li>
    </ul>
  </nav>
  }
</div>
