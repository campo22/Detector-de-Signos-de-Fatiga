<div class="bg-card rounded-b-lg shadow-lg overflow-hidden border-t border-border flex flex-col">
  <div class="overflow-x-auto flex-1">
    <table class="w-full text-sm text-left text-muted-foreground">
      <thead
        class="text-xs text-muted-foreground uppercase bg-secondary/30 backdrop-blur-sm sticky top-0 z-10"
      >
        <tr>
          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('placa')"
          >
            Placa @if(sortState().column === 'placa'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>

          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('marca')"
          >
            Marca @if(sortState().column === 'marca'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>

          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('modelo')"
          >
            Modelo @if(sortState().column === 'modelo'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>

          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('anio')"
          >
            Año @if(sortState().column === 'anio'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>

          <th
            scope="col"
            class="px-6 py-3 cursor-pointer hover:text-primary transition-colors"
            (click)="changeSort('activo')"
          >
            Estado @if(sortState().column === 'activo'){
            <span class="material-symbols-outlined text-sm align-middle ml-1">
              {{ sortState().direction === 'asc' ? 'arrow_upward' : 'arrow_downward' }}
            </span>
            }
          </th>

          <th scope="col" class="px-6 py-3">Conductor Asignado</th>

          <th scope="col" class="px-6 py-3 text-center">Acciones</th>
        </tr>
      </thead>
      @if (vehiclesPage(); as page) {
      <tbody>
        @for (vehicle of page.content; track vehicle.id) {
        <tr class="bg-card border-b border-border hover:bg-muted/30 transition-colors">
          <td class="px-6 py-4 font-medium text-foreground whitespace-nowrap">
            {{ vehicle.placa }}
          </td>

          <td class="px-6 py-4">{{ vehicle.marca }}</td>

          <td class="px-6 py-4">{{ vehicle.modelo || 'N/A' }}</td>

          <td class="px-6 py-4">{{ vehicle.anio }}</td>

          <td class="px-6 py-4">
            <p-tag
              [value]="vehicle.activo ? 'Activo' : 'Inactivo'"
              [severity]="vehicle.activo ? 'success' : 'danger'"
              [rounded]="true"
            />
          </td>

          <td class="px-6 py-4">
            {{ vehicle.driverAsignado?.nombre || 'Sin Asignar' }}
          </td>

          <td class="px-6 py-4 text-center">
            <div class="flex items-center justify-center gap-2">
              <button
                pTooltip="Editar Vehículo"
                tooltipPosition="top"
                (click)="onEditVehicle(vehicle)"
                class="p-1 text-muted-foreground hover:text-primary transition-colors"
              >
                <span class="material-symbols-outlined">edit</span>
              </button>
              <button
                pTooltip="Eliminar Vehículo"
                tooltipPosition="top"
                (click)="onDeleteVehicle(vehicle)"
                class="p-1 text-muted-foreground hover:text-red-500 transition-colors"
              >
                <span class="material-symbols-outlined">delete</span>
              </button>
            </div>
          </td>
        </tr>
        }
      </tbody>
      }
    </table>

    @if (vehiclesPage() !== null && vehiclesPage()?.content?.length === 0) {
    <div class="text-center text-muted-foreground p-10">
      <span class="material-symbols-outlined text-4xl mb-2">no_crash</span>
      <p>No se encontraron vehículos con los filtros aplicados.</p>
    </div>
    } @if (vehiclesPage() === null) {
    <div class="flex items-center justify-center text-muted-foreground p-10">
      <span class="material-symbols-outlined text-4xl animate-spin mr-2">progress_activity</span>
      Cargando vehículos...
    </div>
    }
  </div>
  @if (vehiclesPage(); as page) {
  <nav
    aria-label="Navegación de la tabla"
    class="flex flex-col sm:flex-row items-center justify-between p-4 border-t border-border gap-3"
  >
    <span class="text-sm font-normal text-muted-foreground">
      Mostrando <span class="font-semibold text-foreground">{{ page.numberOfElements }}</span> de
      <span class="font-semibold text-foreground">{{ page.totalElements }}</span>
    </span>

    <ul class="inline-flex items-center -space-x-px text-sm h-8">
      <li>
        <button
          (click)="previousPage()"
          [disabled]="page.first"
          class="flex items-center justify-center px-3 h-8 ml-0 leading-tight text-muted-foreground bg-card border border-border rounded-l-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        >
          <span class="material-symbols-outlined text-base">chevron_left</span>
        </button>
      </li>
      <li class="px-3 h-8 flex items-center text-muted-foreground bg-card border-y border-border">
        Pág {{ page.number + 1 }} de {{ page.totalPages }}
      </li>
      <li>
        <button
          (click)="nextPage()"
          [disabled]="page.last"
          class="flex items-center justify-center px-3 h-8 leading-tight text-muted-foreground bg-card border border-border rounded-r-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        >
          <span class="material-symbols-outlined text-base">chevron_right</span>
        </button>
      </li>
    </ul>
  </nav>
  }
</div>
